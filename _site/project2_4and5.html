<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Urban Pulse: Decoding NYC’s Taxi Tapestry - Features, Imputations, Correlations and Regression models. | Joshua Joel Cuevas</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Urban Pulse: Decoding NYC’s Taxi Tapestry - Features, Imputations, Correlations and Regression models." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction Hi, I’m Josh. A recent graduate with passions in economics, data science, ML and cloud computing. “This intersection therefore is the use of AI to organize and create insights from huge data through cloud computing and will be something many companies will likely be incorporating in the future.” View My LinkedIn Profile" />
<meta property="og:description" content="Introduction Hi, I’m Josh. A recent graduate with passions in economics, data science, ML and cloud computing. “This intersection therefore is the use of AI to organize and create insights from huge data through cloud computing and will be something many companies will likely be incorporating in the future.” View My LinkedIn Profile" />
<link rel="canonical" href="/project2_4and5.html" />
<meta property="og:url" content="/project2_4and5.html" />
<meta property="og:site_name" content="Joshua Joel Cuevas" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Urban Pulse: Decoding NYC’s Taxi Tapestry - Features, Imputations, Correlations and Regression models." />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Introduction Hi, I’m Josh. A recent graduate with passions in economics, data science, ML and cloud computing. “This intersection therefore is the use of AI to organize and create insights from huge data through cloud computing and will be something many companies will likely be incorporating in the future.” View My LinkedIn Profile","headline":"Urban Pulse: Decoding NYC’s Taxi Tapestry - Features, Imputations, Correlations and Regression models.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/images/selfie2%20black%20bg.jpg?raw=true"}},"url":"/project2_4and5.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=796678d21ea504f3ae637dd938b475ad057d4b2c">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-000000-0', 'auto');
    ga('send', 'pageview');
  </script>



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="/">Joshua Joel Cuevas</a></h1>

        
          <img src="/images/selfie2%20black%20bg.jpg?raw=true" alt="Logo" />
        

        <p>Introduction  <br>Hi, I'm Josh. A recent graduate with passions in economics, data science, ML and cloud computing.<br> <br>"This intersection therefore is the use of AI to organize and create insights from huge data through cloud computing and will be something many companies will likely be incorporating in the future."<br> <a href="https://www.linkedin.com/in/joshua-joel-cuevas/">View My LinkedIn Profile</a> 
</p>

        
        <p class="view"><a href="https://github.com/JoshuaCuevasUofT/JoshuaCuevasUofT.github.io">View the Project on GitHub <small>JoshuaCuevasUofT/JoshuaCuevasUofT.github.io</small></a></p>
        

        

        
      </header>
      <section>

      <h2 id="urban-pulse-decoding-nycs-taxi-tapestry---features-imputations-correlations-and-regression-models">Urban Pulse: Decoding NYC’s Taxi Tapestry - Features, Imputations, Correlations and Regression models.</h2>

<p><strong>Project description:</strong> 
Building A/B testing to work on predicting the taxi fare amounts. Working through feature engineering to eventually building a multiple linear regression model.</p>

<h3 id="1-eda-and-hypothesis-testing">1. EDA and Hypothesis Testing</h3>
<p>Analyzing the Relationship Between Fare Amount and Payment Type for NYC TLC through A/B tests. The goal is to create A/B test results to find ways to generate more revenue for taxi cab drivers.
Null Hypothesis: No average fare difference between credit card and cash users.
Alternative Hypothesis: Average fare differs between credit card and cash users.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#hypothesis test, A/B test
#significance level
</span>
<span class="n">credit_card</span> <span class="o">=</span> <span class="n">taxi_data</span><span class="p">[</span><span class="n">taxi_data</span><span class="p">[</span><span class="s">'payment_type'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s">'fare_amount'</span><span class="p">]</span>
<span class="n">cash</span> <span class="o">=</span> <span class="n">taxi_data</span><span class="p">[</span><span class="n">taxi_data</span><span class="p">[</span><span class="s">'payment_type'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">][</span><span class="s">'fare_amount'</span><span class="p">]</span>
<span class="n">stats</span><span class="p">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">credit_card</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">cash</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>TtestResult(statistic=24.001590159839903, pvalue=8.786609175537095e-127, df=69652.62095524809)</p>

<p>P-value is significantly smaller than 5%, therefore, there is a statistically significant difference in the average fare amount between customers who use credit cards and customers who use cash.</p>

<h3 id="2-insights">2. Insights</h3>
<p>1) Encouraging credit card payments can boost revenue for taxi drivers.</p>

<p>2) This project assumes passengers were randomly assigned payment methods. However, the dataset lacks consideration for factors like trip length influencing payment type, suggesting fare amount may dictate payment method more than the other way around.</p>

<h3 id="3-eda--checking-model-assumptions">3. EDA &amp; Checking Model Assumptions</h3>
<p>Analyze and discover data, looking for correlations, missing data, outliers, and duplicates.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df0</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Shape of dataframe:'</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Shape of dataframe with duplicates dropped:'</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">().</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Total count of missing values:'</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">().</span><span class="nb">sum</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Missing values per column:'</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<p>Shape of dataframe: (100000, 17)
Shape of dataframe with duplicates dropped: (100000, 17)
Total count of missing values: 0
Missing values per column:</p>

<p>Unnamed: 0               0
tpep_pickup_datetime     0
tpep_dropoff_datetime    0
passenger_count          0
trip_distance            0
RatecodeID               0
store_and_fwd_flag       0
PULocationID             0
DOLocationID             0
payment_type             0
fare_amount              0
extra                    0
mta_tax                  0
tip_amount               0
tolls_amount             0
improvement_surcharge    0
total_amount             0
dtype: int64</p>

<p>We’ve got outliers, like a hefty $200 tip and a whopping $1,200 total amount. Plus, some variables, like mta_tax, are pretty much stuck in one place, not bringing much prediction power.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Display descriptive stats about the data
</span><span class="n">df</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">df</span><span class="p">[[</span><span class="s">"tip_amount"</span><span class="p">,</span><span class="s">"total_amount"</span><span class="p">,</span><span class="s">"mta_tax"</span><span class="p">]].</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="images/project 2/1.PNG?raw=true" /></p>

<p>Convert pickup &amp; dropoff columns to datetime and create duration column</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Convert datetime columns to datetime
# Display data types of `tpep_pickup_datetime`, `tpep_dropoff_datetime`
</span><span class="k">print</span><span class="p">(</span><span class="s">'Data type of tpep_pickup_datetime:'</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">].</span><span class="n">dtype</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Data type of tpep_dropoff_datetime:'</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_dropoff_datetime'</span><span class="p">].</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Convert `tpep_pickup_datetime` to datetime format
</span><span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">])</span>

<span class="c1"># Convert `tpep_dropoff_datetime` to datetime format
</span><span class="n">df</span><span class="p">[</span><span class="s">'tpep_dropoff_datetime'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'tpep_dropoff_datetime'</span><span class="p">])</span>

<span class="c1"># Display data types of `tpep_pickup_datetime`, `tpep_dropoff_datetime`
</span><span class="k">print</span><span class="p">(</span><span class="s">'Data type of tpep_pickup_datetime:'</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">].</span><span class="n">dtype</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Data type of tpep_dropoff_datetime:'</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_dropoff_datetime'</span><span class="p">].</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Create `duration` column
</span><span class="n">df</span><span class="p">[</span><span class="s">'duration'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'tpep_dropoff_datetime'</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">'m'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="4-box-plots">4. Box Plots</h3>

<p>1) All three numbers have some weird values. Some are really out there, others not so much.
2) The distance from Staten Island to Manhattan is about 30 miles in a straight line. Considering this and how the numbers are spread, it makes sense to let them be. But, fare_amount and duration have some wonky high values.
3) Maybe it’s cool for the last two, but for trip_distance, it’s a bit iffy.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'Boxplots for outlier detection'</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'trip_distance'</span><span class="p">])</span>
<span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'fare_amount'</span><span class="p">])</span>
<span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'duration'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
</code></pre></div></div>

<p><img src="images/project 2/2.png?raw=true" /></p>

<h3 id="5-imputations">5. Imputations</h3>

<p>Some trip distances show up as 0. Are these mistakes or just super short rides getting rounded down?
Sometimes passengers bail, making the distance zero. Just to check, let’s see how many rides actually have a trip_distance of zero.
Only 148 out of around 23,000 rides have a zero distance. Tiny, right? You could slap on a 0.01 for them, but it won’t shake up the model much. So, we’ll just let the trip_distance column be.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'trip_distance'</span><span class="p">]))[:</span><span class="mi">10</span><span class="p">]</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'trip_distance'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#642
</span></code></pre></div></div>
<p>[0.0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09]
642</p>

<p>Fare_amount outliers and Cleanup:
Low values: Negatives are a no-go, but zeros are fine if the trip got axed right away.
High values: The max fare hits almost a grand, which is fishy. So, let’s cap the crazies using intuition and statistics. The IQR math says stop at $26.50, but that feels off. We’ll use a factor of <code class="language-plaintext highlighter-rouge">6</code>, which results in a cap of $62.50.
AKA Impute the maximum value as <code class="language-plaintext highlighter-rouge">Q3 + (6 * IQR)</code>.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">outlier_imputer</span><span class="p">(</span><span class="n">column_list</span><span class="p">,</span> <span class="n">iqr_factor</span><span class="p">):</span>
    <span class="s">'''
    Impute upper-limit values in specified columns based on their interquartile range.

    Arguments:
        column_list: A list of columns to iterate over
        iqr_factor: A number representing x in the formula:
                    Q3 + (x * IQR). Used to determine maximum threshold,
                    beyond which a point is considered an outlier.

    The IQR is computed for each column in column_list and values exceeding
    the upper threshold for each column are imputed with the upper threshold value.
    '''</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">column_list</span><span class="p">:</span>
        <span class="c1"># Reassign minimum to zero
</span>        <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Calculate upper threshold
</span>        <span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
        <span class="n">upper_threshold</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="p">(</span><span class="n">iqr_factor</span> <span class="o">*</span> <span class="n">iqr</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'q3:'</span><span class="p">,</span> <span class="n">q3</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'upper_threshold:'</span><span class="p">,</span> <span class="n">upper_threshold</span><span class="p">)</span>

        <span class="c1"># Reassign values &gt; threshold to threshold
</span>        <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_threshold</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper_threshold</span>
        <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">describe</span><span class="p">())</span>
        <span class="k">print</span><span class="p">()</span>

<span class="n">outlier_imputer</span><span class="p">([</span><span class="s">'fare_amount'</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>

</code></pre></div></div>

<p>count    100000.000000
mean         12.943215
std          11.362632
min         -52.000000
25%           6.500000
50%           9.500000
75%          14.500000
max         312.500000
Name: fare_amount, dtype: float64</p>

<p>q3: 14.5
upper_threshold: 62.5
count    100000.000000
mean         12.851976
std          10.589691
min           0.000000
25%           6.500000
50%           9.500000
75%          14.500000
max          62.500000
Name: fare_amount, dtype: float64</p>

<h3 id="6-feature-engineering">6. Feature Engineering</h3>

<p>When the model’s out in the wild, it won’t predict trip duration upfront. But we can use known trip stats to make educated guesses.
Let’s use a mean_distance column by grouping trips by pickup and dropoff points, calculating averages, to create new insights!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">rush_hourizer</span><span class="p">(</span><span class="n">hour</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">6</span> <span class="o">&lt;=</span> <span class="n">hour</span><span class="p">[</span><span class="s">'rush_hour'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="mi">16</span> <span class="o">&lt;=</span> <span class="n">hour</span><span class="p">[</span><span class="s">'rush_hour'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'pickup_dropoff'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'PULocationID'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s">'DOLocationID'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'pickup_dropoff'</span><span class="p">).</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)[[</span><span class="s">'trip_distance'</span><span class="p">]]</span>
<span class="n">grouped_dict</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">grouped_dict</span> <span class="o">=</span> <span class="n">grouped_dict</span><span class="p">[</span><span class="s">'trip_distance'</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s">'mean_distance'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'pickup_dropoff'</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s">'mean_distance'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'mean_distance'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="n">grouped_dict</span><span class="p">)</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'pickup_dropoff'</span><span class="p">).</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)[[</span><span class="s">'duration'</span><span class="p">]]</span>
<span class="n">grouped_dict</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">grouped_dict</span> <span class="o">=</span> <span class="n">grouped_dict</span><span class="p">[</span><span class="s">'duration'</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s">'mean_duration'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'pickup_dropoff'</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s">'mean_duration'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'mean_duration'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="n">grouped_dict</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'day'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">day_name</span><span class="p">().</span><span class="nb">str</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s">'month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%b'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1"># Create 'rush_hour' col
</span><span class="n">df</span><span class="p">[</span><span class="s">'rush_hour'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'tpep_pickup_datetime'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">hour</span>

<span class="c1"># If day is Saturday or Sunday, impute 0 in `rush_hour` column
</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'day'</span><span class="p">].</span><span class="n">isin</span><span class="p">([</span><span class="s">'saturday'</span><span class="p">,</span> <span class="s">'sunday'</span><span class="p">]),</span> <span class="s">'rush_hour'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Apply the `rush_hourizer()` function to the new column
</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">.</span><span class="n">day</span> <span class="o">!=</span> <span class="s">'saturday'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">day</span> <span class="o">!=</span> <span class="s">'sunday'</span><span class="p">),</span> <span class="s">'rush_hour'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">rush_hourizer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s">"rush_hour"</span><span class="p">,</span><span class="s">"mean_duration"</span><span class="p">,</span><span class="s">"mean_distance"</span><span class="p">,</span> <span class="s">"pickup_dropoff"</span><span class="p">]].</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="images/project 2/3.PNG?raw=true" /></p>

<h3 id="7-scatter-plots-pair-plots-and-correlation-tablesheatmaps">7. Scatter plots, pair plots and correlation tables/heatmaps</h3>

<p>a scatterplot to visualize the relationship between <code class="language-plaintext highlighter-rouge">mean_duration</code> and <code class="language-plaintext highlighter-rouge">fare_amount</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s">'whitegrid'</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">f</span><span class="p">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'mean_duration'</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'fare_amount'</span><span class="p">],</span>
            <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s">'s'</span><span class="p">:</span><span class="mi">5</span><span class="p">},</span>
            <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'color'</span><span class="p">:</span><span class="s">'red'</span><span class="p">})</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Mean duration x fare amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="images/project 2/4.png?raw=true" /></p>

<p>After dropping features that are redundant and irrelevant or won’t be avaible in a deployed enviroment I create a pairplot to visualize pairwise relationships between <code class="language-plaintext highlighter-rouge">fare_amount</code>, <code class="language-plaintext highlighter-rouge">mean_duration</code>, and <code class="language-plaintext highlighter-rouge">mean_distance</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[[</span><span class="s">'fare_amount'</span><span class="p">,</span> <span class="s">'mean_duration'</span><span class="p">,</span> <span class="s">'mean_distance'</span><span class="p">]],</span>
             <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span><span class="mf">0.4</span><span class="p">,</span> <span class="s">'size'</span><span class="p">:</span><span class="mi">5</span><span class="p">},</span>
             <span class="p">)</span>
</code></pre></div></div>

<p><img src="images/project 2/5.png?raw=true" /></p>

<p>Next we should create a correlation matrix to help determine most correlated variables.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">df2</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'pearson'</span><span class="p">))</span>
<span class="c1"># Create correlation heatmap
</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df2</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'pearson'</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Reds'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Correlation heatmap'</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="images/project 2/6.png?raw=true" /></p>

<h3 id="8-constructing-the-model">8. Constructing the model</h3>

<p>Preproccessing. Splitting data into outcome variable and features. Standardizing data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Remove the target column from the features
</span><span class="n">X</span> <span class="o">=</span> <span class="n">df2</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'fare_amount'</span><span class="p">])</span>

<span class="c1"># Set y variable
</span><span class="n">y</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[[</span><span class="s">'fare_amount'</span><span class="p">]]</span>

<span class="c1"># Get dummies
</span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># Create training and testing sets
</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Standardize the X variables
</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">().</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'X_train scaled:'</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">)</span>
</code></pre></div></div>

<p>Fitting the model to the training data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fit your model to the training data
</span><span class="n">lr</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div>

<p>Evaluating the model on train data and test data</p>

<p>Train data</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Evaluate the model performance on the training data
</span><span class="n">r_sq</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Coefficient of determination:'</span><span class="p">,</span> <span class="n">r_sq</span><span class="p">)</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'R^2:'</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'MAE:'</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'MSE:'</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'RMSE:'</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)))</span>
</code></pre></div></div>

<p>Coefficient of determination: 0.8379324295648474
R^2: 0.8379324295648474
MAE: 2.3323595594005897
MSE: 18.270924842792795
RMSE: 4.2744502386614345</p>

<p>Test data</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Evaluate the model performance on the testing data
</span><span class="n">r_sq_test</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Coefficient of determination:'</span><span class="p">,</span> <span class="n">r_sq_test</span><span class="p">)</span>
<span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'R^2:'</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'MAE:'</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred_test</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'MSE:'</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'RMSE:'</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)))</span>
</code></pre></div></div>
<p>Coefficient of determination: 0.8378668322065665
R^2: 0.8378668322065665
MAE: 2.3267246851541388
MSE: 17.793089610596432
RMSE: 4.218185582759065</p>

<h3 id="9-visualizing-model-results">9. Visualizing Model Results</h3>

<p>Results for <code class="language-plaintext highlighter-rouge">actual</code>,<code class="language-plaintext highlighter-rouge">predicted</code>, and <code class="language-plaintext highlighter-rouge">residual</code> for the testing set.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a `results` dataframe
</span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">'actual'</span><span class="p">:</span> <span class="n">y_test</span><span class="p">[</span><span class="s">'fare_amount'</span><span class="p">],</span>
                             <span class="s">'predicted'</span><span class="p">:</span> <span class="n">y_pred_test</span><span class="p">.</span><span class="n">ravel</span><span class="p">()})</span>
<span class="n">results</span><span class="p">[</span><span class="s">'residual'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s">'actual'</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s">'predicted'</span><span class="p">]</span>
<span class="n">results</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="images/project 2/7.PNG?raw=true" /></p>

<p>Scatterplot for Actual versus Predicted data points</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a scatterplot to visualize `predicted` over `actual`
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s">'whitegrid'</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'actual'</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="s">'predicted'</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
<span class="p">)</span>
<span class="c1"># Draw an x=y line to show what the results would be if the model were perfect
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s">'red'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Actual vs. predicted'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="images/project 2/8.png?raw=true" /></p>

<p>Visualize the distribution of the <code class="language-plaintext highlighter-rouge">residuals</code> using a histogram
The leftover variance, aka residuals, dances in a nearly normal distribution with an average of -0.015.
This means our model’s errors play fair, spread evenly, and keep things unbiased.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Visualize the distribution of the `residuals`
</span><span class="n">sns</span><span class="p">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s">'residual'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mf">15.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Distribution of the residuals'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'residual value'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'count'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="images/project 2/9.png?raw=true" /></p>

<p>Create a scatterplot of <code class="language-plaintext highlighter-rouge">residuals</code> over <code class="language-plaintext highlighter-rouge">predicted</code>.
Residuals extist above and below zero, which is expected. Those sloping lines are from the $62.50 cap and $52 JFK flat rate we plugged in.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a scatterplot of `residuals` over `predicted`
</span>
<span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'predicted'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'residual'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Scatterplot of residuals over predicted values'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'predicted value'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'residual value'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="images/project 2/10.png?raw=true" /></p>

<h3 id="10-coefficients">10. Coefficients</h3>
<p>The heavy hitter in the prediction game is mean_distance. But, hold your horses! Don’t fall for the trap. It’s not a simple “for every mile” tale. 
Nope! We used StandardScaler() on our training data, so the units are in standard deviations, not miles. So, it’s more like, “for every +1 change in standard deviation,” the fare dances up by $7.13.</p>

<p>we didn’t kick out some pesky correlated features, so the confidence interval is a bit shaky.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Get model coefficients
</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">coefficients</span>

<span class="k">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s">'mean_distance'</span><span class="p">].</span><span class="n">std</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="mf">7.133867</span> <span class="o">/</span> <span class="n">X_train</span><span class="p">[</span><span class="s">'mean_distance'</span><span class="p">].</span><span class="n">std</span><span class="p">())</span>
</code></pre></div></div>

<p><img src="images/project 2/11.PNG?raw=true" /></p>

<p>3.600633254666103
1.9812812067863723</p>

<h3 id="11-follow-up">11. Follow up</h3>

<p>More work must be done to prepare the predictions to be used as inputs into the model. Specifically, imputing constant fare rate of $52 for all trips with rate code “2.”</p>



      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/JoshuaCuevasUofT">JoshuaCuevasUofT</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
